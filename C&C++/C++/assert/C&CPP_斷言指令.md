### C/C++ 斷言指令（assert）教學

目錄
- 什麼是斷言指令？
- 幾種常見的斷言指令
- C/C++ 中斷言指令的使用方式與注意事項
- 總結

什麼是斷言指令？

「斷言（assert）」的意思是：當程式執行到某個條件時，檢查該條件是否成立。
如果條件不成立，就會執行一個「非常規動作」，通常是立刻中止程式運行，方便開發者在除錯階段發現邏輯錯誤。

簡單來說，斷言是用來保證「理論上不該發生的情況」真的不會發生。
一旦發生，就表示程式邏輯有問題，應該立即檢查。

幾種常見的斷言指令

| 指令        | 行為                                     | 備註                     |
| ----------- | ---------------------------------------- | ------------------------ |
| **assert**  | 條件為假時中止執行。                     | 最常用於 C/C++。         |
| **verify**  | 條件為假時顯示錯誤訊息，但程式繼續執行。 | 常見於部分框架或測試庫。 |
| **waitfor** | 直到條件成立才繼續往下執行。             | 類似同步等待行為。       |

C/C++ 中斷言指令的使用與注意事項

在 C/C++ 中，斷言是以巨集（macro）形式定義於 <assert.h>（或 C++ 的 <cassert>）中。
其原型如下：

``` cpp
#include <assert.h>
void assert(int expression);
```

assert() 的作用是判斷 expression 的結果：
- 如果為 true（非 0） → 繼續執行程式。
- 如果為 false（0） → 會：
  1. 在標準錯誤輸出（stderr）中列印錯誤訊息；
  2. 透過 abort() 中止程式執行。

範例：

``` cpp
#include <assert.h>
#include <string.h>

void copy(char* dest, const char* src) {
    assert(dest != nullptr);
    assert(src != nullptr);

    strcpy(dest, src);
}

int main() {
    char* ptr = nullptr;
    copy(ptr, "hello"); // 這裡會觸發 assert
    return 0;
}
```

當 assert() 條件不成立時，程式會立即停止並顯示出錯的位置與檔案名稱。

注意事項
- assert 主要在 Debug 模式 下啟用，用於開發階段的邏輯檢查。
若在 Release 模式（定義 NDEBUG）下編譯，所有的 assert() 會自動被忽略，完全不影響效能。
- 過度使用 assert() 會拖慢程式效能，因為每次執行都會多一次條件判斷。
- 斷言不是錯誤處理機制。
    它只適合檢查「不應該發生的狀況」，像是：

``` cpp
assert(index < array_size); // 理論上 index 不會超出
```

若是可以預期或可恢復的錯誤，應該使用例外（try-catch）或明確的錯誤回傳機制。

總結
- 斷言是一種偵錯機制，主要在開發與測試階段使用。
- 當條件不成立時，會輸出錯誤訊息並中止程式。
- Release 版本中會被自動關閉，不影響效能。
- 對於「可預期或可恢復的錯誤」，不要使用斷言，而應採用錯誤處理或異常機制。
- 更好的做法是搭配單元測試（unit test）來驗證邏輯正確性。